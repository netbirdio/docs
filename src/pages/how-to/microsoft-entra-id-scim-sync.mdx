# Provision Users and Groups From Microsoft Entra ID via SCIM

[Microsoft Entra ID](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id),
formerly known as Azure Active Directory (Azure AD), is a cloud-based identity and access management service that provides
organizations with secure authentication, single sign-on, and user management capabilities. In the context of network security,
it can be effectively used to control network access based on organizational structure, such as groups and individual user accounts.

NetBird's Microsoft Entra ID SCIM integration allows you to synchronize users and groups from Entra ID to NetBird.
You can then use these synchronized groups to configure your network, create network access policies, and automate
onboarding and offboarding processes.

## Prerequisites

Before you begin the integration process, ensure you have the necessary admin permissions in Microsoft Entra ID. You need an Azure user account with at least one of these roles:

* Application Administrator
* Cloud Application Administrator
* Global Administrator

## Enabling Microsoft Entra ID SCIM in NetBird

To enable SCIM synchronization in NetBird, navigate to `Integrations > Identity Provider Sync` in your NetBird dashboard.

![NetBird Entra ID Integration](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-connect.png)

Click the `Connect Microsoft Entra ID` button to begin the configuration process.

![NetBird Entra ID Getting Started](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-scim-getting-started.png)

Click `Get Started` to launch the configuration wizard. You will be guided through several configuration options:

**Groups to be synchronized**

By default, all groups assigned to the NetBird application in Microsoft Entra ID will be synchronized. If you want to synchronize only assigned groups that start with a specific prefix, you can specify them in the filter. Keep in mind that the prefix matching is case-sensitive.

![NetBird Entra ID Group Filter](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-scim-group-filter.png)

Click `Continue` to proceed to the next step.

**Users to be synchronized**

By default, all users from the groups assigned to the NetBird application will be synchronized. If you want to further filter and synchronize only users from specific assigned groups, you can specify those group names in the filter. The group name matching is case-sensitive.

![NetBird Entra ID User Group Filter](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-scim-user-group-filter.png)

Click `Continue` to generate your SCIM credentials.

**SCIM Credentials**

NetBird will generate the SCIM credentials required to configure Microsoft Entra ID. Make note of both the **Base URL** and **Token Key** as you will need them in the next section to complete the Microsoft Entra ID configuration.

![NetBird Entra ID SCIM Credentials](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-scim-credentials.png)

Click `Finish Setup` to complete the NetBird SCIM configuration.

![NetBird Entra ID SCIM Enabled](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-scim-enabled.png)

You can now proceed to configure SCIM provisioning in Microsoft Entra ID using the credentials generated above.

## Configure SCIM Provisioning in Microsoft Entra ID

In the [Azure portal](https://portal.azure.com), navigate to `Azure Active Directory` â†’ `Enterprise applications`.

![Microsoft Entra ID Enterprise Applications](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-enterprise-applications.png)

Click `New application` to create a new enterprise application.

![Entra ID New Application](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-new-application.png)

Click `Create your own application`.

Fill out the application form with the following details:

* **What's the name of your app?**: `NetBird SCIM`
* **What are you looking to do with your application?**: Select `Integrate any other application you don't find in the gallery (Non-gallery)`

![Entra ID Application Form](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-application-form.png)

Click `Create`.

![Entra ID Application Created](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-application-created.png)

### Enable Provisioning

After the application is created, you'll see a getting started page with different actions. Click `Get started` in the `Provision User Accounts` section.

![Entra ID Provisioning Get Started](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-provisioning-get-started.png)

Under the `Create configuration` section, click `connect your application`.

Fill out the `New provisioning configuration` form with the following details:

* **Select authentication method**: `Bearer authentication`
* **Tenant URL**: `https://api.netbird.io/api/scim/v2` (paste the Base URL you copied from NetBird)
* **Secret token**: Paste the Token Key you copied from NetBird

![Entra ID Connect Application](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-connect-application.png)

Click `Test Connection` to verify the SCIM connection, If the connection is successful, you'll see a success message. Click `Create` to save the configuration.

![Microsoft Entra ID Connection Success](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-connection-success.png)

### Configure Attribute Mapping

After creating the provisioning configuration, you need to configure the attribute mapping to ensure the `externalId` is mapped to the user's `objectId`.

Navigate to the `Attribute mapping` section and click `Provision Microsoft Entra ID Users`.

![Entra ID Default Attribute Mapping](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-default-attribute-mapping.png)

In the attribute mappings list, locate the `externalId` row and click `Edit`.

Change the **Source attribute** from `mailNickname` to `objectId`.

![Entra ID externalId](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-edit-externalid.png)

Click `Ok` to save the change, then click `Save` to apply the new attribute mapping configuration.

![Entra ID Updated Attribute Mapping](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-updated-attribute-mapping.png)

## Assign Users and Groups

To enable SCIM synchronization of users and groups to NetBird, you need to assign them to the NetBird enterprise application.

In the Azure portal, navigate to your NetBird enterprise application:

* Click on `Users and groups` in the left menu
* Click `+ Add user/group`
* Select the users and groups you want to synchronize to NetBird
* Click `Assign` to save the assignments

![Entra ID Assign Users and Groups](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-assign-users-groups.png)

## Start Provisioning

After assigning users and groups, navigate back to the provisioning configuration and click the `Start provisioning` button to enable automatic synchronization. The first sync will begin shortly after provisioning is started.

![Entra ID Provisioning Started](/docs-static/img/how-to-guides/entra-id-scim-sync/entra-provisioning-started.png)

Once started, Microsoft Entra ID will automatically synchronize the assigned users and groups to NetBird.

## Verify Synchronization

After starting provisioning, the synchronization will begin automatically. You can verify that users and groups
have been successfully synchronized by navigating to `Team > Users` in your NetBird dashboard.

![NetBird Verify Users](/docs-static/img/how-to-guides/entra-id-scim-sync/netbird-verify-users.png)

<Note>
    SCIM provisioning will manage only resources that are created through Microsoft Entra ID. Any resources created directly in NetBird will not be managed by SCIM.
</Note>

<Note>
    Synced groups will only be available for membership and will not change the role of user in NetBird
</Note>