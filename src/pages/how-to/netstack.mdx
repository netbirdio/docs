
# Netstack: VPN in Cloud Function Environment

Cloud function environments often come with limited network capabilities. Netstack, a feature within the NetBird agent, provides a solution by granting secure access to the NetBird network. In general, NetBird creates secure VPN access using the TUN device. However, in this solution, instead of utilizing the TUN device, the agent opens a SOCKS5 proxy service on a specified port to provide access to the protected network.

By enabling the SOCKS5 proxy and configuring your application accordingly, you can overcome network limitations and ensure secure communication. Additionally, the flexibility of environment variables allows you to customize the Netstack feature based on your specific requirements.

## Run agent with Netstack Feature
You can customize Netstack feature behavior on the NetBird agent using environment variables:

<b>NB_USE_NETSTACK_MODE</b>: Set to true to enable Netstack mode. Set to false to disable Netstack mode.
<b>NB_SOCKS5_LISTENER_PORT</b>: Set the port where the Socks5 proxy listens (e.g., NB_SOCKS5_LISTENER_PORT=1080).

Example:
```bash
NB_USE_NETSTACK_MODE=true
NB_SOCKS5_LISTENER_PORT=1080
```

<Note>
    The DNS feature is not supported yet. You can reach the peers by IP address only.
</Note>

## Apply SOCKS5 proxy

While configuration steps may vary across applications, the key parameters usually include:

- SOCKS Version: 5
- SOCKS Host: IP address of the container where the agent is running
- SOCKS Port: By default, set to 1080