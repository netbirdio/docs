import {Note} from "@/components/mdx";

# PocketID

[PocketID](https://pocket-id.org/) is a simplified identity management solution designed for self-hosted environments, offering a lightweight and easy-to-deploy option for authentication.

<Note>
PocketID is secure and effective but makes some tradeoffs in terms of features. Notably, it does not allow scoping the access of API Tokens. Keep careful track of the token used by NetBird for management.
</Note>

## Management Setup (Recommended)

Add PocketID as an external IdP directly in the NetBird Management Dashboard. This is the simplest approach and recommended for most deployments.

### Prerequisites

- NetBird self-hosted with embedded IdP enabled
- PocketID instance with admin access

### Step 1: Create OIDC Client in PocketID

1. Navigate to PocketID console
2. Click the **Administration** dropdown in the left-hand bar
3. Select **OIDC Clients**
4. Click **Add** to create a new client

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/1_add-oidc-client-pocketid.png" alt="Add OIDC client" className="imagewrapper-big"/>
</p>

5. Fill in the form:
   - **Name**: `NetBird`
   - **Public Client**: Off (for confidential client)
   - **PKCE**: Off
6. Click **Save**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/2_save-oidc-client-pocketid.png" alt="Save OIDC client" className="imagewrapper-big"/>
</p>

7. Note the **Client ID** and **Client Secret**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/3_note-client-id-pocketid.png" alt="Note client ID" className="imagewrapper-big"/>
</p>

### Step 2: Add Identity Provider in NetBird

1. Log in to your NetBird Dashboard
2. Navigate to **Settings** → **Identity Providers**
3. Click **Add Identity Provider**
4. Fill in the fields:

| Field | Value |
|-------|-------|
| Type | PocketID |
| Name | PocketID (or your preferred display name) |
| Client ID | From PocketID |
| Client Secret | From PocketID |
| Issuer | `https://pocketid.example.com` |

<Note>
**Important:** Make sure not to add a trailing slash "/" after the issuer URL for PocketID. This differs from some of the other providers.
</Note>

5. Click **Save**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/4_netbird-config-pocketid.png" alt="NetBird configuration" className="imagewrapper-big"/>
</p>

### Step 3: Configure Redirect URI

After saving, NetBird displays the **Redirect URL**. Copy this URL and add it to your PocketID client:

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/5_copy-redirect-netbird-pocketid.png" alt="Copy redirect URL from NetBird" className="imagewrapper-big"/>
</p>

1. Return to PocketID console → **OIDC Clients**
2. Edit your NetBird client
3. Add the redirect URL to **Callback URLs**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/6_add-callback-url-pocketid.png" alt="Add callback URL" className="imagewrapper-big"/>
</p>

4. Click **Save**

### Step 4: Create User Group and Assign to Client

1. Return to PocketID console → **User Groups**
2. Click **Add** to create a new group
3. Fill in:
   - **Name**: `NetBird`
4. Click **Save**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/7_add-user-group-pocketid.png" alt="Add user group" className="imagewrapper-big"/>
</p>

5. Add users to the NetBird group:
   - Click on the **NetBird** group
   - Click **Add Users**
   - Select the users who should have access to NetBird
   - Click **Save** or **Add**

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/8_add-group-to-user-pocketid.png" alt="Add users to group" className="imagewrapper-big"/>
</p>

6. Go to **OIDC Clients** → **NetBird** (the client you created earlier)
7. Find the **Groups** or **User Groups** section
8. Add the **NetBird** group to the client

<p>
    <img src="/docs-static/img/selfhosted/identity-providers/self-hosted/pocketid/9_add-group-to-oidc-pocketid.png" alt="Add group to OIDC client" className="imagewrapper-big"/>
</p>

9. Click **Save**

### Step 5: Test the Connection

1. Log out of NetBird Dashboard
2. On the login page, you should see a "PocketID" button
3. Click it and authenticate with your PocketID credentials
4. You should be redirected back to NetBird and logged in

### Configuring JWT 'groups' Claim

PocketID includes user groups in the ID token by default when you've assigned groups to users and linked those groups to the OIDC client. If you followed Step 4 above, groups should already be included in the token.

#### Verify Groups Are Included

1. Ensure you've created a User Group in PocketID (Step 4)
2. Ensure users are assigned to the group
3. Ensure the group is linked to your NetBird OIDC client

#### Enable JWT Group Sync in NetBird

1. In NetBird Dashboard, go to **Settings** → **Groups**
2. Enable **JWT group sync**
3. Set **JWT claim** to `groups`
4. Optionally configure **JWT allow groups** to restrict access to users in specific PocketID groups

<Note>
PocketID restricts OIDC client access based on group membership. Only users in groups assigned to the OIDC client can authenticate. This is configured in Step 4 above.
</Note>

---

## Standalone Setup (Advanced)

Use PocketID as your primary identity provider instead of NetBird's embedded IdP. This option gives you full control over authentication and user management, is recommended for experienced PocketID administrators as it also requires additional setup and ongoing maintenance.

For most deployments, the [embedded IdP](/selfhosted/identity-providers/local) is the simpler choice — it's built into NetBird, fully integrated, and requires minimal configuration to get started. For this implementation, go back up to the [Management Setup (Recommended)](#management-setup-recommended) section above.

For detailed instructions on the standalone setup, see the [PocketID SSO with NetBird Self-Hosted (Advanced)](/selfhosted/identity-providers/advanced/pocketid) documentation.

---

## Troubleshooting

### "Invalid redirect URI" error

- Ensure all callback URLs are properly configured in PocketID
- Include both HTTP (localhost) and HTTPS (domain) variants

---

## Related Resources

- [PocketID Documentation](https://pocket-id.org/docs)
- [Embedded IdP Overview](/selfhosted/identity-providers/local)